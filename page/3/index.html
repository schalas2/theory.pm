
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>theory.pm</title>
  <meta name="author" content="David E. Wheeler">

  
  <meta name="description" content="Ricardo Signes: One of the big new experimental features in Perl 5.18.0 is lexical subroutines. In other words, you can write this: my sub quickly &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://theory.pm/page/3">
  <link href="/favicon.ico" rel="icon">
  
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  
  

  

</head>

<body   class="no-sidebar"  >
  <header role="banner"><hgroup>
  <h2><a href="/"><img src="/images/logo.png" alt="::" /></a></h2>
  <h1><a href="/">theory.pm</a></h1>
</hgroup>

</header>
  <nav role="navigation">
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:theory.pm" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about/">About</a></li>
  <li><a href="/archives">Archives</a></li>
  <li><a href="https://metacpan.org/author/DWHEELER">CPAN</a></li>
  <li><a href="http://pgxn.org/user/theory">PGXN</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
    
    



  







    <article data-linklog>
      
  <header>
    <h1 class="entry-title">

<a href="http://rjbs.manxome.org/rubric/entry/2016">Lexical Subroutines</a>
<span class='linklog-marker'>→</span>
</h1>

    
      <p class="meta">
        








  


<time datetime="2013-09-25T20:12:00-07:00" pubdate data-updated="true">Wednesday, 25 September 2013</time>
        
         &bull; <a rel="bookmark" href="/syntax/2013/09/25/lexical-subroutines/">§</a>
      </p>
    
  </header>



  <div class="entry-content"><p>Ricardo Signes:</p>

<blockquote><p>One of the big new experimental features in Perl 5.18.0 is lexical
 subroutines. In other words, you can write this:</p>

<pre><code>my sub quickly { ... }
my @sorted = sort quickly @list;

my sub greppy (&amp;@) { ... }
my @grepped = greppy { ... } @input;
</code></pre>

<p>These two examples show cases where lexical <em>references</em> to anonymous
subroutines would not have worked. The first argument to <code>sort</code> must be a
block or a subroutine <em>name</em>, which leads to awful code like this:</p>

<pre><code>sort { $subref-&gt;($a, $b) } @list
</code></pre>

<p>With our greppy, above, we get to benefit from the parser-affecting
behaviors of subroutine prototypes.</p></blockquote>

<p>My favorite tidbit about this feature? Because lexical subs are <em>lexical,</em> and
method-dispatch is <em>package</em>-based, lexical subs are not subject to method
lookup and dispatch! This just might alleviate the confusion of methods and
subs, as <a href="http://www.modernperlbooks.com/mt/2013/09/functions-shouldnt-be-methods-yet-another-reminder.html">chromatic complained about just yesterday</a>. Probably doesn&rsquo;t solve
the problem for imported subs, though.</p>
</div>


    </article>
  
    
    



  







    <article data-linklog>
      
  <header>
    <h1 class="entry-title">

<a href="http://techblog.net-a-porter.com/2013/08/dbixmultirow-updating-multiple-database-rows-quickly-and-easily/">Multirow Database Updates</a>
<span class='linklog-marker'>→</span>
</h1>

    
      <p class="meta">
        








  


<time datetime="2013-09-09T17:47:00-07:00" pubdate data-updated="true">Monday,  9 September 2013</time>
        
         &bull; <a rel="bookmark" href="/sql/2013/09/09/multirow-database-updates/">§</a>
      </p>
    
  </header>



  <div class="entry-content"><p>William Blunn:</p>

<blockquote><p>So, given a list of updates to apply we could effect them using the
following steps:</p>

<ol>
<li>Use CREATE TEMPORARY TABLE to create a temporary table to hold the
updates</li>
<li>Use INSERT to populate the temporary table with the updates</li>
<li>Use UPDATE … FROM to update the target table using updates in the
temporary table</li>
<li>Use DROP TABLE to drop the temporary table</li>
</ol>


<p>So in the example above we can reduce five statements to four. This isn’t a
significant improvement in this case. But now the number of statements is no
longer directly dependent on the number of rows requiring updates.</p>

<p><strong>Even if we wanted to update a thousand rows with different values, we
could still do it with four statements.</strong></p></blockquote>

<p>Or you could just use one statement. Here&rsquo;s how to do it with a <a href="http://www.postgresql.org/docs/current/static/queries-with.html" title="PostgreSQL Documentation: WITH Queries (Common Table Expressions)">CTE</a> on
PostgreSQL 9.2 and higher:</p>

<figure class='code'><figcaption><span>PostgreSQL Multirow Upate with CTE</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">WITH</span> <span class="n">up</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">salary</span><span class="p">)</span> <span class="k">AS</span> <span class="p">(</span> <span class="k">VALUES</span>
</span><span class='line'>     <span class="p">(</span><span class="s1">&#39;Jane&#39;</span><span class="p">,</span>  <span class="mi">1200</span><span class="p">),</span>
</span><span class='line'>     <span class="p">(</span><span class="s1">&#39;Frank&#39;</span><span class="p">,</span> <span class="mi">1100</span><span class="p">),</span>
</span><span class='line'>     <span class="p">(</span><span class="s1">&#39;Susan&#39;</span><span class="p">,</span> <span class="mi">1175</span><span class="p">),</span>
</span><span class='line'>     <span class="p">(</span><span class="s1">&#39;John&#39;</span><span class="p">,</span>  <span class="mi">1150</span><span class="p">)</span>
</span><span class='line'><span class="p">)</span>
</span><span class='line'><span class="k">UPDATE</span> <span class="n">staff</span>
</span><span class='line'>   <span class="k">SET</span> <span class="n">salary</span> <span class="o">=</span> <span class="n">up</span><span class="p">.</span><span class="n">salary</span>
</span><span class='line'>  <span class="k">FROM</span> <span class="n">up</span>
</span><span class='line'> <span class="k">WHERE</span> <span class="n">staff</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">up</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Still on PostgreSQL 9.1 or lower? Use a subselect in the <code>FROM</code> clause
instead:</p>

<figure class='code'><figcaption><span>PostgreSQL Multirow Update with Subselect</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">UPDATE</span> <span class="n">staff</span>
</span><span class='line'>   <span class="k">SET</span> <span class="n">salary</span> <span class="o">=</span> <span class="n">up</span><span class="p">.</span><span class="n">salary</span>
</span><span class='line'>   <span class="k">FROM</span> <span class="p">(</span><span class="k">VALUES</span>
</span><span class='line'>       <span class="p">(</span><span class="s1">&#39;Jane&#39;</span><span class="p">,</span>  <span class="mi">1200</span><span class="p">),</span>
</span><span class='line'>       <span class="p">(</span><span class="s1">&#39;Frank&#39;</span><span class="p">,</span> <span class="mi">1100</span><span class="p">),</span>
</span><span class='line'>       <span class="p">(</span><span class="s1">&#39;Susan&#39;</span><span class="p">,</span> <span class="mi">1175</span><span class="p">),</span>
</span><span class='line'>       <span class="p">(</span><span class="s1">&#39;John&#39;</span><span class="p">,</span>  <span class="mi">1150</span><span class="p">)</span>
</span><span class='line'>   <span class="p">)</span> <span class="k">AS</span> <span class="n">up</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">salary</span><span class="p">)</span>
</span><span class='line'> <span class="k">WHERE</span> <span class="n">staff</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">up</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Stuck with MySQL or Oracle? Use a <code>UNION</code> query in a second table:</p>

<figure class='code'><figcaption><span>MySQL & Oracle Multirow Update</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">UPDATE</span> <span class="n">staff</span><span class="p">,</span> <span class="p">(</span>
</span><span class='line'>         <span class="k">SELECT</span> <span class="s1">&#39;Jane&#39;</span> <span class="k">AS</span> <span class="n">name</span><span class="p">,</span> <span class="mi">1200</span> <span class="k">AS</span> <span class="n">salary</span>
</span><span class='line'>   <span class="k">UNION</span> <span class="k">SELECT</span> <span class="s1">&#39;Frank&#39;</span><span class="p">,</span>        <span class="mi">1100</span>
</span><span class='line'>   <span class="k">UNION</span> <span class="k">SELECT</span> <span class="s1">&#39;Susan&#39;</span><span class="p">,</span>        <span class="mi">1175</span>
</span><span class='line'>   <span class="k">UNION</span> <span class="k">SELECT</span> <span class="s1">&#39;John&#39;</span><span class="p">,</span>         <span class="mi">1150</span>
</span><span class='line'><span class="p">)</span> <span class="k">AS</span> <span class="n">up</span>
</span><span class='line'>   <span class="k">SET</span> <span class="n">staff</span><span class="p">.</span><span class="n">salary</span> <span class="o">=</span> <span class="n">up</span><span class="p">.</span><span class="n">salary</span>
</span><span class='line'> <span class="k">WHERE</span> <span class="n">staff</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">up</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Using SQLite? Might make sense to use a temporary table for thousands or
millions of rows. But for just a few, use a <code>CASE</code> expression:</p>

<figure class='code'><figcaption><span>SQLite Multirow Update</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">UPDATE</span> <span class="n">staff</span>
</span><span class='line'>   <span class="k">SET</span> <span class="n">salary</span> <span class="o">=</span> <span class="k">CASE</span> <span class="n">name</span>
</span><span class='line'>       <span class="k">WHEN</span> <span class="s1">&#39;Jane&#39;</span>  <span class="k">THEN</span> <span class="mi">1200</span>
</span><span class='line'>       <span class="k">WHEN</span> <span class="s1">&#39;Frank&#39;</span> <span class="k">THEN</span> <span class="mi">1100</span>
</span><span class='line'>       <span class="k">WHEN</span> <span class="s1">&#39;Susan&#39;</span> <span class="k">THEN</span> <span class="mi">1175</span>
</span><span class='line'>       <span class="k">WHEN</span> <span class="s1">&#39;John&#39;</span>  <span class="k">THEN</span> <span class="mi">1150</span>
</span><span class='line'>   <span class="k">END</span>
</span><span class='line'> <span class="k">WHERE</span> <span class="n">name</span> <span class="k">in</span> <span class="p">(</span><span class="s1">&#39;Jane&#39;</span><span class="p">,</span> <span class="s1">&#39;Frank&#39;</span><span class="p">,</span> <span class="s1">&#39;Susan&#39;</span><span class="p">,</span> <span class="s1">&#39;John&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you need to support multiple database architectures, sure, use something
like <a href="https://github.com/hochgurgler/DBIx-MultiRow" title="DBIx::MultiRow on GitHub">DBIx::MultiRow</a> to encapsulate things. But if, like most of us, you&rsquo;re
on one database for an app, I can&rsquo;t recommend stongly enough how well it pays
to get to know your database well.</p>
</div>


    </article>
  
    
    









    <article >
      
  <header>
    <h1 class="entry-title">

<a href="/sqitch/2013/09/06/sqitch-templating/">Sqitch Templating</a>

</h1>

    
      <p class="meta">
        








  


<time datetime="2013-09-06T13:44:00-07:00" pubdate data-updated="true">Friday,  6 September 2013</time>
        
         &bull; <a rel="bookmark" href="/sqitch/2013/09/06/sqitch-templating/">§</a>
      </p>
    
  </header>



  <div class="entry-content"><p>Last week saw the v.980 release of <a href="http://sqitch.org/" title="Sane database change management">Sqitch</a>, a database change management
system. The headline feature in this version is support for <a href="http://dev.mysql.com/" title="The world's most popular open source database">MySQL</a> 5.6.4 or
higher. Why 5.6.4 rather than 5.1 or even 5.5? Mainly because 5.6.4 finally
added support for fractional seconds in <code>DATETIME</code> columns (details in the
<a href="https://dev.mysql.com/doc/relnotes/mysql/5.6/en/news-5-6-4.html" title="Changes in MySQL 5.6.4 (2011-12-20, Milestone 7)">release notes</a>). This feature is essential for Sqitch, because changes often
execute within a second of each other, and the deploy time is included in the
log table&rsquo;s primary key.</p>

<p>With the requirement for fractional seconds satisfied by 5.6.4, there was
nothing to prevent usage of <a href="http://dev.mysql.com/doc/refman/5.5/en/condition-handling.html" title="MySQL 5.5 Reference Manual: Condition Handling"><code>SIGNAL</code></a>, added in 5.5, to
<a href="http://stackoverflow.com/a/17424570/79202" title="How do I get MySQL to throw a conditional runtime exception in SQL">mimic check constraints</a> in a trigger. This brings the Sqitch MySQL
implementation into line with what was already possible in the Postgres,
SQLite, and Oracle support. Check out the <a href="https://metacpan.org/module/sqitchtutorial-mysql" title="A tutorial introduction to Sqitch change management on MySQL">tutorial</a> and the accompanying
<a href="https://github.com/theory/sqitch-mysql-intro" title="Sqitch MySQL Intro Sample Repository">Git repository</a> to get started managing your MySQL databases with Sqitch.</p>

<p>The MySQL support might be the headliner, but the change in v0.980 I&rsquo;m most
excited about is improved template support. Sqitch executes templates to
create the default deploy, revert, and verify scripts, but up to now they have
not been easy to customize. With v0.980, you can create as many custom
templates as you like, and use them as appropriate.</p>

</div>
  <footer>
    <a rel="full-article" href="/sqitch/2013/09/06/sqitch-templating/">do continue →</a>
  </footer>


    </article>
  
    
    



  







    <article data-linklog>
      
  <header>
    <h1 class="entry-title">

<a href="http://tapoueh.org/blog/2013/08/20-Window-Functions">Understanding Window Functions</a>
<span class='linklog-marker'>→</span>
</h1>

    
      <p class="meta">
        








  


<time datetime="2013-08-28T17:25:00-07:00" pubdate data-updated="true">Wednesday, 28 August 2013</time>
        
         &bull; <a rel="bookmark" href="/pg/windows/2013/08/28/understanding-window-functions/">§</a>
      </p>
    
  </header>



  <div class="entry-content"><p>Dimitri Fontaine:</p>

<blockquote><p>There was SQL before
<a href="http://www.postgresql.org/docs/current/static/tutorial-window.html">window functions</a>
and SQL after <em>window functions:</em> that&rsquo;s how powerful this tool is. Being
that of a deal breaker unfortunately means that it can be quite hard to
grasp the feature. This article aims at making it crystal clear so that you
can begin using it today and are able to reason about it and recognize cases
where you want to be using <em>window functions.</em></p></blockquote>

<p>Great intro to a powerful feature.</p>
</div>


    </article>
  
    
    









    <article >
      
  <header>
    <h1 class="entry-title">

<a href="/sqitch/data/2013/08/28/data-deployment-with-sqitch/">Data Deployment with Sqitch</a>

</h1>

    
      <p class="meta">
        








  


<time datetime="2013-08-28T17:09:00-07:00" pubdate data-updated="true">Wednesday, 28 August 2013</time>
        
         &bull; <a rel="bookmark" href="/sqitch/data/2013/08/28/data-deployment-with-sqitch/">§</a>
      </p>
    
  </header>



  <div class="entry-content"><p>I&rsquo;ve been thinking about data migrations. I love how well <a href="http://sqitch.org/">Sqitch</a> works for
<em>schema</em> changes, but so far have avoided <em>data</em> changes. Some data ought to
be managed by the deployment process, rather than by end-user applications.
Lists of countries, for example. Yet none of <a href="http://iovation.com/">our</a> Sqitch-managed databases
include <code>INSERT</code>s, <code>UPDATE</code>s, or <code>DELETE</code>s in deploy scripts. Why not? Two
reasons:</p>

<ol>
<li><p>These are mainly Postgres ports of existing Oracle databases. As such, I&rsquo;ve
written independent migration scripts that use <a href="http://pgxn.org/extension/oracle_fdw"><code>oracle_fdw</code></a> to copy data
from Oracle. It made no sense to commit hard-coded changes to the deploy
script, even for static data, as it was all to be copied from the old
production Oracle databases &mdash; often months after I wrote the migrations.</p></li>
<li><p>These projects include extensive <a href="http://pgtap.org/">pgTAP</a> unit tests that expect to run many
times against an empty database with no side effects. Having different data
in testing than in production increases the likelihood of unforeseen
behavioral variations. Better to expect <em>no</em> data in tests, freeing them to
focus on units of behavior without regard to preexisting data.</p></li>
</ol>


<p>Now that we have multiple Sqitch-deployed databases in production, the time
has come to address these issues.</p>

<h2>Deploy Hooks for External Sources</h2>

<p>I propose to resolve the one-time migration requirement with <a href="https://github.com/theory/sqitch/issues/96">deploy hooks</a>.
The idea is similar to <a href="http://git-scm.com/docs/githooks">Git hooks</a>: Before or after any <code>sqitch deploy</code>, one
or more hook scripts can run. The impetus was to ensure some higher level of
consistency after every <code>deploy</code>. For example, a post-deploy hook might grant
privileges on all tables in a database. Another might run <code>VACCUM; ANALZYE;</code>.</p>

<p>But we could also use it for one-time data migrations. An option to <code>deploy</code>
will disable them, which would be useful for development and test databases.
Once the migration has been run in production, we just delete the migration
hook scripts from the project. Sqitch won&rsquo;t record hook executions, so adding
or removing them will be no problem.</p>

<p>I like this approach, as Sqitch will automatically run migration scripts, but
hooks will not change the interface of Sqitch itself. And it&rsquo;s more generally
useful. Hell, I might want deploy hook script that sends an email notification
announcing a deployment (though that might require adding support for
<a href="https://github.com/theory/sqitch/issues/1">non-SQL scripts</a>). There are all kinds of things for which hooks will prove
useful.</p>

<h2>Changes for Static Data Maintenance</h2>

<p>For data that must be tied to the deployment process, there are two
complications that have prevetned me from simply managing them in normal
Sqitch changes:</p>

<ol>
<li><p>There might be side-effects to the deployment. For example, a foreign key
constraint to the <code>users</code> table, to identify the users who added rows to
the database. But in a new database, perhaps there are no users &mdash; and
Sqitch doesn&rsquo;t create them, the app does. Chicken, meet egg.</p></li>
<li><p>The initial data set might derived from some external source, such as
another database. Consequently, none of that data was defined in Sqitch
deploy scripts. This situation complicates future updates of the data. We
can add data via Sqitch in the future, but then we don&rsquo;t have the canonical
list of all rows that should exist in all such databases.</p></li>
</ol>


<p>However, I can think of no alternative that does not over-complicate Sqitch
itself. I considered adding another change-related script type, named
&ldquo;update&rdquo;, to complement the existing deploy, verify, and revert scripts. But
oftentimes a data change would not be tied to a schema change, so the
corresponding deploy script would be a no-op. Seems silly.</p>

<p>I also considered adding a completely separate command specifically for
deploying data changes. Yet these data migrations are exactly like schema
changes: Sqitch must execute them in the proper order relative to other
changes, record successful or failed deployment, and be able to revert them
when required. The only difference is what&rsquo;s defined in them: data
modification rather than definition.</p>

<p>Through several drafts of this post, I have come around to the idea that I
should change nothing in Sqitch with regard to data deployments. A better
solution than the above, I believe, is organizational.</p>

<h3>Data Deploy Best Practice</h3>

<p>Let the best practice for data deploys be this: they should be contained in
Sqitch changes, but such changes should contain <em>only</em> data modifications. No
change script should both define a table and insert its initial rows. Keep the
table and its data in separate changes &mdash; keep DML separate from DDL.</p>

<p>For our list of countries, we might have a change named &ldquo;countries&rdquo;, which
creates the <code>countries</code> table, and another, named &ldquo;country_data&rdquo;, which
inserts the appropriate data into that table. Where necessary and appropriate,
these changes may use conditional paths to bring the data up-to-date and in
sync across deployments.</p>

<p>Conditions must deal with side-effects, such as foreign key constraints. Where
possible, such side effects ought be removed from deployment-managed data. For
tracking the user or users who added data to a database, for example, one can
use the tools of the source code repository (<code>git log</code>, <code>git blame</code>) to assign
blame. Other side-effects may be more necessary, but to the extent possible,
deployed data should be independent.</p>

<p>Naturally, unit tests must expect static data to be present, and be updated
when that data changes. We are, after all, talking about infrequently-updated
data. Frequently-updated data should have separate interfaces provided by
applications to change the data. Otherwise, how static is it, really?</p>
</div>


    </article>
  
    
    



  







    <article data-linklog>
      
  <header>
    <h1 class="entry-title">

<a href="http://news.perlfoundation.org/2013/08/2013q3-grant-proposals.html">TPF To Revamp Grants</a>
<span class='linklog-marker'>→</span>
</h1>

    
      <p class="meta">
        








  


<time datetime="2013-08-23T17:28:00-07:00" pubdate data-updated="true">Friday, 23 August 2013</time>
        
         &bull; <a rel="bookmark" href="/tpf/2013/08/23/tpf-to-revamp-grants/">§</a>
      </p>
    
  </header>



  <div class="entry-content"><p>Alberto Simões:</p>

<blockquote><p>Nevertheless, this lack of &ldquo;lower than $3000&rdquo; grant proposals, and the fact
that lot of people have been discussing (and complaining) about this value
being too low, the Grants Committee is starting a discussion on rewriting
and reorganizing the way it works. Namely, in my personal blog I
<a href="http://blogs.perl.org/users/alberto_simoes/2013/02/about-the-grants-committee.html">opened a discussion</a> about the Grants Committee some time ago, and had
plenty of feedback, that will be helpful for our internal discussion.</p></blockquote>

<p>This is great news. I would love to see more and more ambitious grant
proposals, as well as awards people an subsist on. I look forward to seeing
the new rules.</p>
</div>


    </article>
  
    
    



  







    <article data-linklog>
      
  <header>
    <h1 class="entry-title">

<a href="http://blogs.perl.org/users/stevan_little/2013/08/mapping-the-mop-to-moose.html">Mopping the Moose</a>
<span class='linklog-marker'>→</span>
</h1>

    
      <p class="meta">
        








  


<time datetime="2013-08-15T13:44:00-07:00" pubdate data-updated="true">Thursday, 15 August 2013</time>
        
         &bull; <a rel="bookmark" href="/mop/2013/08/15/mopping-the-moose/">§</a>
      </p>
    
  </header>



  <div class="entry-content"><p>Stevan Little:</p>

<blockquote><p>I spent much of last week on vacation with the family so very little actual
coding got done on the <a href="https://github.com/stevan/p5-mop-redux">p5-mop</a>, but instead I did a lot of thinking. My
next major goal for the <a href="https://github.com/stevan/p5-mop-redux">p5-mop</a> is to port a module written in <a href="https://metacpan.org/module/Moose">Moose</a>, in
particular, one that uses many different <a href="https://metacpan.org/module/Moose">Moose</a> features. The module I have
chosen to port is <a href="https://metacpan.org/module/Bread::Board">Bread::Board</a> and I chose it for two reasons; first, it
was the first real module that I wrote using <a href="https://metacpan.org/module/Moose">Moose</a> and second, it makes
heavy use of a lot of <a href="https://metacpan.org/module/Moose">Moose</a>&rsquo;s features.</p></blockquote>

<p>I&rsquo;m so happy to see Stevan making progress on the Perl 5 MOP again.</p>
</div>


    </article>
  
    
    









    <article >
      
  <header>
    <h1 class="entry-title">

<a href="/blog/2013/07/26/a-perl-blog/">A Perl Blog</a>

</h1>

    
      <p class="meta">
        








  


<time datetime="2013-07-26T18:08:00-07:00" pubdate data-updated="true">Friday, 26 July 2013</time>
        
         &bull; <a rel="bookmark" href="/blog/2013/07/26/a-perl-blog/">§</a>
      </p>
    
  </header>



  <div class="entry-content"><p>I have been unsatisfied with <a href="http://justatheory.com/">Just a Theory</a> for some time. I started that
blog in 2004 more or less for fun, thinking it would be my permanent home on
the internet. And it has been. But the design, while okay in 2004, is just
awful by today&rsquo;s standards. A redesign is something I have planned to do for
quite some time.</p>

<p>I had also been thinking about my audience. Or rather, audiences. I&rsquo;ve blogged
about many things, but while a few dear family members might want to read
everything I ever post, most folks, I think, are interested in only a subset
of topics. Readers of <a href="http://justatheory.com/">Just a Theory</a> came for posts about Perl, or
PostgreSQL, or culture, travel, or politics. But few came for all those
topics, in my estimation.</p>

<p>More recently, a whole bunch of top-level domains have opened up, often with
the opportunity for anyone to register them. I was lucky enough to snag
<code>theory.pm</code> and <code>theory.pl</code>, thinking that perhaps I would create a site just
for blogging about Perl. I also nabbed <code>theory.so</code>, which I might dedicate to
database-related blogging, and <code>theory.me</code>, which would be my personal blog
(travel, photography, cultural essays, etc.).</p>

<p>And then there is <a href="http://octopress.org">Octopress</a>. A blogging engine for hackers. Perfect for me.
Hard to imagine something more appropriate (unless it was written in Perl). It
seemed like a good opportunity to partition my online blogging.</p>

<p>So here we are with my first partition. <a href="/">theory.pm</a> is a Perl blog. Seemed
like the perfect name. I fiddled with it off and on for a few months, often
following <a href="http://mattgemmell.com/2013/05/22/designing-blogs-for-readers/">Matt Gemmell&rsquo;s Advice</a>, and I&rsquo;m really happy with it. The
open-source fonts <a href="https://github.com/adobe/source-sans-pro">Source Sans Pro</a> and <a href="https://github.com/adobe/source-code-pro">Source Code Pro</a>, from Adobe, look
great. The source code examples are beautifully marked up and displayed using
the <a href="http://ethanschoonover.com/solarized">Solarized</a> color scheme (though presentation varies in feed readers).
Better still, it&rsquo;s equally attractive and readable on computers, tablets and
phones, thanks to the foundation laid by Aron Cedercrantz’s <a href="https://github.com/rastersize/BlogTheme">BlogTheme</a>.</p>

<p>I expect to fork this code to create a database blog soon, and then perhaps
put together a personal blog. Maybe the personal blog will provide link posts
for posts on the other sites, so that if anyone really wants to read
everything, they can. I haven&rsquo;t decided yet.</p>

<p>In the meantime, now that I have a dedicated Perl blog, I guess I&rsquo;ll have to
start writing more Perl-related stuff. I&rsquo;m starting with some posts about the
state of exception handling in Perl 5, the first of which is <a href="/exceptions/2013/07/26/trying-times/">already up</a>. Stay
tuned for more.</p>
</div>


    </article>
  
    
    









    <article >
      
  <header>
    <h1 class="entry-title">

<a href="/exceptions/2013/07/26/trying-times/">Trying Times</a>

</h1>

    
      <p class="meta">
        








  


<time datetime="2013-07-26T15:20:00-07:00" pubdate data-updated="true">Friday, 26 July 2013</time>
        
         &bull; <a rel="bookmark" href="/exceptions/2013/07/26/trying-times/">§</a>
      </p>
    
  </header>



  <div class="entry-content"><p>Exception handling is a bit of a pain in Perl. Traditionally, we use
<code>eval {}</code>:</p>

<figure class='code'><figcaption><span>Perl eval</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="nb">eval</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">foo</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="k">my</span> <span class="nv">$err</span> <span class="o">=</span> <span class="vg">$@</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1"># Inspect $err…</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The use of the <code>if</code> block is a bit unfortunate; worse is the use of the global
<code>$@</code> variable, which has inflicted unwarranted pain on developers over the
years<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>. Many Perl hackers put <a href="https://metacpan.org/module/Try::Tiny">Try::Tiny</a> to work to circumvent these
shortcomings:</p>

<figure class='code'><figcaption><span>Try::Tiny</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="n">try</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">foo</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span> <span class="n">catch</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1"># Inspect $_…</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>Alas, Try::Tiny introduces its own idiosyncrasies, particularly its use of
subroutine references rather than blocks. While a necessity of a pure-Perl
implementation, it prevents <code>return</code>ing from the calling context. One must
work around this deficiency by <a href="http://stackoverflow.com/a/10366209/79202">checking return values</a>:</p>

<figure class='code'><figcaption><span>Return from Try::Tiny</span><a href='http://stackoverflow.com/a/10366209/79202'>More Gotchas</a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="k">my</span> <span class="nv">$rv</span> <span class="o">=</span> <span class="n">try</span> <span class="p">{</span>
</span><span class='line'>   <span class="n">f</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span> <span class="n">catch</span> <span class="p">{</span>
</span><span class='line'>   <span class="c1"># …</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$rv</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>   <span class="k">return</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>I can&rsquo;t tell you how often this quirk burns me.</p>

</div>
  <footer>
    <a rel="full-article" href="/exceptions/2013/07/26/trying-times/">do continue →</a>
  </footer>


    </article>
  
  <div class="pagination">
    
    <a href="/archives">Blog Archives</a>
    
    <a class="next" href="/page/2/">Newer &rarr;</a>
    
  </div>
</div>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 – David E. Wheeler –
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span> –
  <a href="/atom.xml" title="Subscribe to theory.com">Feed</a>
</p>

</footer>
  











</body>
</html>
